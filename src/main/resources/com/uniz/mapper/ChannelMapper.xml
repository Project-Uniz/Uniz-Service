<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
	<mapper namespace="com.uniz.mapper.ChannelMapper">
		<!-- 채널 게시판 목록 보여주기 -->
		<select id="getChannelList" resultType="com.uniz.domain.ChannelVO">
			select channelsn,  channeltitle, CHANNELCOMMENT ,createdatetime
			from channel
			
		</select>
		
		<!-- 해당 게시판의 게시글 목록 보여주기 -->
		<select id ="getPostList" resultType="com.uniz.domain.ChannelBoardVO">
			select channelsn , title , createdatetime
			from channelpost
			where channelsn = #{channelSN}
		</select>
		
		<!-- 게시글 보여 주기 -->
		<select id ="getPost" resultType="com.uniz.domain.ChannelBoardVO">
			select p.channelsn , p.postsn, p.usersn, p.title , p.createdatetime , c.postContent
			from channelpost p , channelpostcontent c
			where p.postsn = #{postSN} and c.postSN = p.postSN
		</select>
	
		<insert id="createChannel">
			insert into channel (channelsn, channeltitle, channelcomment, createdatetime, updatedatetime)
			values(channel_seq.nextval, #{channelTitle} , #{channelComment} , sysdate , sysdate)
		</insert>
		
		<insert id="insertPost">
			<selectKey keyProperty="postSN" order="BEFORE" resultType="long">
				select channelpost_seq.nextval from dual
			</selectKey>
				insert into channelpost(postsn, channelsn, usersn, title , createdatetime, updatedatetime )
				values(#{postSN} , #{channelSN} , #{userSN} , #{title}, sysdate, sysdate)
		</insert>	
		
		<insert id="insertCont">
		
		insert into channelpostcontent (postSN , postcontent)
		values (#{postSN} , #{postContent} )
	
		</insert>
		
		<delete id="deletePost">
			delete from ChannelPost where postSN = #{postSN}
		</delete>
		
		<delete id="deleteCont">
			delete from ChannelPostContent where postSN = #{postSN}
		</delete>
		
		<update id="updatePost" parameterType="com.uniz.domain.ChannelBoardVO">
			update ChannelPost
			set title = #{title},
			updatedatetime = sysdate
			where postSN = #{postSN}
		</update>
		
		<update id="updateCont" parameterType="com.uniz.domain.ChannelBoardVO">
			update ChannelPostContent
			set postContent = #{postContent}
			where postSN = #{postSN}
		</update>
		
	</mapper>