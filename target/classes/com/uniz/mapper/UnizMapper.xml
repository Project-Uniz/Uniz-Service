<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.uniz.mapper.UnizMapper">

	<select id="getPresetList" resultType = "com.uniz.domain.UnizVO">
	<![CDATA[
	SELECT
		u.*
	FROM
		uniz u, presetunizlist p
	WHERE
		p.menuSN = #{menusn}
		AND p.unizSN = u.unizSN
	ORDER BY
		p.priority
	]]>
	</select>

	<insert id="insertNoSeq">
	INSERT INTO uniz (unizSN, unizTypeSN, unizKeyword, imgUrl)
		VALUES (#{unizSN}, #{unizTypeSN}, #{unizKeyword}, #{imgUrl})
	</insert>

	<insert id="insertSelectKey">
	<selectKey keyProperty="unizSN" order="BEFORE" resultType="Long">
	SELECT UNIZ_SEQ.nextval FROM dual
	</selectKey>
	INSERT INTO uniz (unizSN, unizTypeSN, unizKeyword, imgUrl)
		VALUES (#{unizSN}, #{unizTypeSN}, #{unizKeyword}, #{imgUrl})
	</insert>

	<select id="read" resultType="com.uniz.domain.UnizVO">
	SELECT * FROM uniz WHERE unizSN = #{unizSN}
	</select>

	<select id="readByKeyword" resultType="com.uniz.domain.UnizVO">
	SELECT * FROM uniz WHERE unizKeyword = #{keyword} AND unizTypeSN = #{unizType} 
	</select>

	<select id="readByKeywordForUserUnizInsert" resultType="com.uniz.domain.UnizVO">
	SELECT * FROM uniz WHERE unizKeyword = #{keyword} AND unizTypeSN IN (8, 9, 10) AND ROWNUM = 1
	</select>
	
	<select id="getListByKeyword" resultType = "com.uniz.domain.UnizVO">
	<![CDATA[
	SELECT * FROM uniz WHERE unizKeyword = #{keyword}
	]]>
	</select>

	<select id="getFavoriteList">
	<![CDATA[
	SELECT unizSN FROM myunizpointlist
	WHERE
		userSN = #{userSN}
		AND point >= #{fvPoint}
		AND ROWNUM <= #{limit}
	ORDER BY point DESC

	]]>
	</select>

	<delete id="delete">
	DELETE FROM uniz WHERE unizSN = #{unizSN}
	</delete>

	<update id="update">
	UPDATE
		uniz
	SET
		unizTypeSN = #{unizTypeSN},
		unizKeyword = #{unizKeyword},
		imgUrl = #{imgUrl},
		enable = #{enable},
		updateDateTime = sysdate
	WHERE
		unizSN = #{unizSN}
	</update>
</mapper>